"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.verifyToken = exports.emailTemplate = exports.createToken = void 0;
var jsonwebtoken_1 = __importDefault(require("jsonwebtoken"));
var createToken = function (jwtPayload, secret, expiresIn) {
    return jsonwebtoken_1.default.sign(jwtPayload, secret, { expiresIn: expiresIn });
};
exports.createToken = createToken;
var emailTemplate = function (resetLink) { return "\n  <!DOCTYPE html>\n  <html>\n  <head>\n    <meta charset=\"UTF-8\" />\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n    <meta name=\"color-scheme\" content=\"light\" />\n    <meta name=\"supported-color-schemes\" content=\"light\" />\n    <style>\n      /* Reset styles for email clients */\n      body, html, table, div, p, h1, h2, h3, h4, h5, h6, a, span {\n        margin: 0;\n        padding: 0;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;\n        line-height: 1.5;\n      }\n\n      body {\n        background-color: #f5f5f5;\n        color: #333333;\n        width: 100% !important;\n        height: 100% !important;\n        margin: 0;\n        padding: 0;\n        -webkit-text-size-adjust: 100%;\n        -ms-text-size-adjust: 100%;\n      }\n\n      /* Outlook-specific styles */\n      table {\n        mso-table-lspace: 0pt;\n        mso-table-rspace: 0pt;\n      }\n\n      img {\n        -ms-interpolation-mode: bicubic;\n        border: 0;\n        height: auto;\n        line-height: 100%;\n        outline: none;\n        text-decoration: none;\n      }\n\n      /* Container */\n      .email-container {\n        max-width: 600px;\n        margin: 30px auto;\n        background: #ffffff;\n        border-radius: 12px;\n        overflow: hidden;\n        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);\n      }\n\n      /* Header */\n      .email-header {\n        background-color: #0f766e;\n        color: white;\n        text-align: center;\n        padding: 35px 20px;\n      }\n\n      .logo {\n        margin-bottom: 20px;\n      }\n\n      .logo-text {\n        font-size: 28px;\n        font-weight: 700;\n        color: #ffffff;\n        text-transform: uppercase;\n        letter-spacing: 1px;\n      }\n\n      .header-title {\n        margin: 0;\n        font-size: 26px;\n        font-weight: 700;\n        letter-spacing: -0.5px;\n        color: #ffffff;\n      }\n\n      .header-subtitle {\n        margin: 12px 0 0;\n        font-size: 16px;\n        color: rgba(255, 255, 255, 0.9);\n      }\n\n      /* Body */\n      .email-body {\n        padding: 40px 30px;\n        color: #333333;\n      }\n\n      .greeting {\n        font-size: 20px;\n        font-weight: 600;\n        margin-bottom: 20px;\n        color: #111827;\n      }\n\n      .message {\n        margin-bottom: 30px;\n        font-size: 16px;\n        color: #4b5563;\n        line-height: 1.6;\n      }\n\n      .button-container {\n        text-align: center;\n        margin: 35px 0;\n      }\n\n      /* Button styles with MSO fallback for Outlook */\n      .reset-button {\n        background-color: #0f766e;\n        border-radius: 8px;\n        color: #ffffff;\n        display: inline-block;\n        font-size: 18px;\n        font-weight: 600;\n        line-height: 1;\n        padding: 18px 36px;\n        text-align: center;\n        text-decoration: none;\n        -webkit-text-size-adjust: none;\n        mso-hide: all;\n      }\n\n      /* Outlook button fallback */\n      .button-fallback {\n        border-collapse: separate;\n        mso-table-lspace: 0pt;\n        mso-table-rspace: 0pt;\n        width: 100%;\n      }\n\n      .button-fallback td {\n        padding: 0;\n      }\n\n      .button-fallback-link {\n        background-color: #0f766e;\n        border: solid 1px #0f766e;\n        border-radius: 8px;\n        color: #ffffff !important;\n        cursor: pointer;\n        display: inline-block;\n        font-size: 18px;\n        font-weight: 600;\n        margin: 0;\n        padding: 18px 36px;\n        text-align: center;\n        text-decoration: none;\n      }\n\n      .expiry-notice {\n        margin-top: 30px;\n        padding: 18px;\n        background-color: #fffbeb;\n        border-left: 4px solid #f59e0b;\n        border-radius: 4px;\n        font-size: 15px;\n        color: #92400e;\n      }\n\n      .expiry-notice strong {\n        color: #b45309;\n        font-weight: 700;\n      }\n\n      .link-fallback {\n        margin-top: 30px;\n        padding: 18px;\n        background-color: #f8fafc;\n        border-radius: 8px;\n        font-size: 15px;\n        word-break: break-all;\n      }\n\n      .link-fallback p {\n        margin: 0 0 12px;\n        color: #64748b;\n      }\n\n      .link-fallback a {\n        color: #0f766e;\n        text-decoration: none;\n        font-weight: 500;\n        word-break: break-all;\n      }\n\n      /* Footer */\n      .email-footer {\n        text-align: center;\n        font-size: 14px;\n        color: #64748b;\n        padding: 25px 20px;\n        background-color: #f8fafc;\n        border-top: 1px solid #e2e8f0;\n      }\n\n      .footer-links {\n        margin-bottom: 15px;\n      }\n\n      .footer-links a {\n        color: #0f766e;\n        text-decoration: none;\n        margin: 0 10px;\n        font-weight: 500;\n      }\n\n      .copyright {\n        margin: 10px 0;\n        color: #64748b;\n      }\n\n      .disclaimer {\n        font-size: 13px;\n        color: #94a3b8;\n        margin-top: 10px;\n      }\n\n      /* Responsive */\n      @media only screen and (max-width: 600px) {\n        .email-container {\n          width: 100% !important;\n          margin: 0 !important;\n          border-radius: 0 !important;\n        }\n\n        .email-header {\n          padding: 25px 15px;\n        }\n\n        .email-body {\n          padding: 25px 15px;\n        }\n\n        .reset-button, .button-fallback-link {\n          display: block !important;\n          width: 100% !important;\n          padding: 16px 10px !important;\n          font-size: 16px !important;\n        }\n\n        .footer-links a {\n          display: block;\n          margin: 10px 0;\n        }\n      }\n    </style>\n    <!--[if mso]>\n    <style type=\"text/css\">\n      .email-container {\n        background-color: #ffffff !important;\n      }\n      .email-header {\n        background-color: #0f766e !important;\n      }\n      .reset-button {\n        display: none !important;\n      }\n      .button-fallback {\n        display: block !important;\n      }\n    </style>\n    <![endif]-->\n  </head>\n  <body style=\"margin: 0; padding: 0; background-color: #f5f5f5; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;\">\n    <!-- Preheader text (hidden) -->\n    <div style=\"display: none; max-height: 0; overflow: hidden;\">\n      Reset your GreenUniMind password - Your password reset link is ready\n    </div>\n\n    <!-- Main container -->\n    <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"min-width: 100%; background-color: #f5f5f5;\">\n      <tr>\n        <td align=\"center\" valign=\"top\" style=\"padding: 30px 10px;\">\n          <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"600\" class=\"email-container\" style=\"max-width: 600px; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 16px rgba(0, 0, 0, 0.08);\">\n            <!-- Header -->\n            <tr>\n              <td align=\"center\" valign=\"top\" class=\"email-header\" style=\"background-color: #0f766e; padding: 35px 20px; text-align: center;\">\n                <div class=\"logo\">\n                  <div class=\"logo-text\" style=\"font-size: 28px; font-weight: 700; color: #ffffff; text-transform: uppercase; letter-spacing: 1px;\">GreenUniMind</div>\n                </div>\n                <h1 class=\"header-title\" style=\"margin: 0; font-size: 26px; font-weight: 700; letter-spacing: -0.5px; color: #ffffff;\">Password Reset Request</h1>\n                <p class=\"header-subtitle\" style=\"margin: 12px 0 0; font-size: 16px; color: rgba(255, 255, 255, 0.9);\">Follow the instructions to reset your password</p>\n              </td>\n            </tr>\n\n            <!-- Body -->\n            <tr>\n              <td align=\"left\" valign=\"top\" class=\"email-body\" style=\"padding: 40px 30px; color: #333333;\">\n                <p class=\"greeting\" style=\"font-size: 20px; font-weight: 600; margin-bottom: 20px; color: #111827;\">Hello there,</p>\n\n                <p class=\"message\" style=\"margin-bottom: 30px; font-size: 16px; color: #4b5563; line-height: 1.6;\">\n                  We received a request to reset your password for your GreenUniMind account.\n                  To proceed with resetting your password, please click the button below.\n                </p>\n\n                <!-- Button container -->\n                <div class=\"button-container\" style=\"text-align: center; margin: 35px 0;\">\n                  <!-- Button for most email clients -->\n                  <a href=\"".concat(resetLink, "\" class=\"reset-button\" style=\"background-color: #0f766e; border-radius: 8px; color: #ffffff; display: inline-block; font-size: 18px; font-weight: 600; line-height: 1; padding: 18px 36px; text-align: center; text-decoration: none; -webkit-text-size-adjust: none;\">Reset My Password</a>\n\n                  <!-- Outlook button fallback -->\n                  <!--[if mso]>\n                  <table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"button-fallback\" style=\"border-collapse: separate; mso-table-lspace: 0pt; mso-table-rspace: 0pt; width: 100%;\">\n                    <tr>\n                      <td align=\"center\" style=\"padding: 0;\">\n                        <a href=\"").concat(resetLink, "\" class=\"button-fallback-link\" style=\"background-color: #0f766e; border: solid 1px #0f766e; border-radius: 8px; color: #ffffff !important; cursor: pointer; display: inline-block; font-size: 18px; font-weight: 600; margin: 0; padding: 18px 36px; text-align: center; text-decoration: none;\">Reset My Password</a>\n                      </td>\n                    </tr>\n                  </table>\n                  <![endif]-->\n                </div>\n\n                <!-- Expiry notice -->\n                <div class=\"expiry-notice\" style=\"margin-top: 30px; padding: 18px; background-color: #fffbeb; border-left: 4px solid #f59e0b; border-radius: 4px; font-size: 15px; color: #92400e;\">\n                  <strong style=\"color: #b45309; font-weight: 700;\">Important:</strong> This password reset link will expire in 10 minutes for security reasons.\n                  If you didn't request this password reset, you can safely ignore this email.\n                </div>\n\n                <!-- Link fallback -->\n                <div class=\"link-fallback\" style=\"margin-top: 30px; padding: 18px; background-color: #f8fafc; border-radius: 8px; font-size: 15px; word-break: break-all;\">\n                  <p style=\"margin: 0 0 12px; color: #64748b;\">If the button above doesn't work, copy and paste this link into your browser:</p>\n                  <a href=\"").concat(resetLink, "\" style=\"color: #0f766e; text-decoration: none; font-weight: 500; word-break: break-all;\">").concat(resetLink, "</a>\n                </div>\n              </td>\n            </tr>\n\n            <!-- Footer -->\n            <tr>\n              <td align=\"center\" valign=\"top\" class=\"email-footer\" style=\"text-align: center; font-size: 14px; color: #64748b; padding: 25px 20px; background-color: #f8fafc; border-top: 1px solid #e2e8f0;\">\n                <div class=\"footer-links\" style=\"margin-bottom: 15px;\">\n                  <a href=\"#\" style=\"color: #0f766e; text-decoration: none; margin: 0 10px; font-weight: 500;\">Help Center</a>\n                  <a href=\"#\" style=\"color: #0f766e; text-decoration: none; margin: 0 10px; font-weight: 500;\">Terms of Service</a>\n                  <a href=\"#\" style=\"color: #0f766e; text-decoration: none; margin: 0 10px; font-weight: 500;\">Privacy Policy</a>\n                </div>\n                <p class=\"copyright\" style=\"margin: 10px 0; color: #64748b;\">\u00A9 2024 GreenUniMind. All rights reserved.</p>\n                <p class=\"disclaimer\" style=\"font-size: 13px; color: #94a3b8; margin-top: 10px;\">This is an automated email, please do not reply.</p>\n              </td>\n            </tr>\n          </table>\n        </td>\n      </tr>\n    </table>\n  </body>\n  </html>\n"); };
exports.emailTemplate = emailTemplate;
var verifyToken = function (token, secret) {
    return jsonwebtoken_1.default.verify(token, secret);
};
exports.verifyToken = verifyToken;
